# Tasks Tracker

## Quick Start

This project has a React frontend (Vite) and an Express + Prisma + MySQL backend with LDAP authentication.

1) Clone and install

```bash
git clone <your-repo-url>
cd tasks-tracker
npm install
```

2) Configure environment

- Create a root `.env` for the frontend:

```env
VITE_API_URL=http://localhost:3000
# If you use Supabase features in the UI, set these too (optional)
VITE_SUPABASE_URL=your-url
VITE_SUPABASE_ANON_KEY=your-anon-key
```

- Create `server/.env` for the backend:

```env
PORT=3000
JWT_SECRET=change-me

# MySQL connection
# Format: mysql://USER:PASSWORD@HOST:PORT/DATABASE
DATABASE_URL=mysql://root:password@localhost:3306/tasks_tracker

# LDAP
LDAP_URL=ldap://10.176.18.143:389
LDAP_BIND_DN=uid=admin,ou=people,dc=turnkeyafrica,dc=com
LDAP_BIND_PASSWORD=turnkey4ever
LDAP_BASE_DN=dc=turnkeyafrica,dc=com
LDAP_SEARCH_BASE=ou=people,dc=turnkeyafrica,dc=com
LDAP_DEFAULT_EMAIL_DOMAIN=turnkeyafrica.com
```

3) Generate Prisma client and run migrations

```bash
npx prisma generate --schema server/prisma/schema.prisma
npx prisma migrate deploy --schema server/prisma/schema.prisma
# Or to create a new migration locally, use:
# npx prisma migrate dev --schema server/prisma/schema.prisma
```

4) Run the apps

```bash
# Backend
npm run server:dev

# Frontend (in another terminal)
npm run dev
```

The API will be at `http://localhost:3000`. The frontend dev server usually runs at `http://localhost:5173` and proxies to the API when configured.

## Notes

- The server loads env vars from `server/.env` and also attempts to load a root `.env` as a fallback.
- Prisma schema is at `server/prisma/schema.prisma` and generates the client into `server/src/generated/prisma`.
- If your MySQL runs in Docker on Windows, you may use `host.docker.internal` for the host in `DATABASE_URL`.

## Troubleshooting

- Prisma: Environment variable not found: `DATABASE_URL` → Ensure `server/.env` exists and `DATABASE_URL` is set. Restart the server after changes.
- ESM `__dirname` error → Already handled in `server/src/index.ts` using `import.meta.url`.
- Prisma client not found → Run `npx prisma generate --schema server/prisma/schema.prisma`.

## Development

- Backend code: `server/src`
- Frontend code: `src`

This code was generated by [Magic Patterns](https://magicpatterns.com) for this design: [Source Design](https://www.magicpatterns.com/c/clqwknmtk26hrdszcyvmka)
